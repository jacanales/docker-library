schemaVersion: '2.0.0'
fileExistenceTests:
  - name: 'Check composer exists'
    path: '/usr/local/bin/composer'
    shouldExist: true
    uid: 1000
    gid: 1000
    isExecutableBy: 'group'
  - name: 'Check workdir exists'
    path: '/code'
    shouldExist: true
commandTests:
  - name: "Composer Version"
    command: "composer"
    args: [ "-V" ]
    expectedOutput: [ "Composer version 2.0*" ]
  - name: "PHP Version"
    command: "php"
    args: ["-v"]
    expectedOutput: ["PHP 7.4.12 (cli)*"]
  - name: "PHP installed modules"
    command: "php"
    args: [ "-m" ]
    expectedOutput: [ "apcu", "bcmath", "igbinary", "redis", "sockets" ]
  - name: "PECL installed packages"
    command: "pecl"
    args: [ "list" ]
    expectedOutput: [ "amqp", "apcu", "grpc", "igbinary", "protobuf", "rdkafka", "redis" ]
metadataTest:
  env:
    - key: XDEBUG_REMOTE_HOST
      value: 127.0.0.1
  entrypoint: ["docker-php-entrypoint"]
  exposedPorts: ["9000"]
  cmd: ["php-fpm"]
  workdir: "/code"
